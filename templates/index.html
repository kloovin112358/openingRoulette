<!DOCTYPE html>
<html>
<head>
    <link href="/static/favicon.ico" rel="icon" type="image/x-icon" />
    <script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
    <script src="https://cdn.socket.io/socket.io-3.0.1.min.js"></script>
    <title>Chess Roulette</title>
</head>
<style>
body {
    font-family: 'Trebuchet MS', sans-serif;
}
</style>


<body style='text-align:center;'>

    <div style='margin-bottom:25px;'>
        <a style='font-size:30px;'>Chess Opening Roulette</a>
    </div>

    <div id='gameInformation' style='display:none;margin-bottom:20px;'>
        <div>
            <a id='curGameList'></a>
        </div>
        <a>Current Opening: </a><a id='curOpeningName'></a>
    </div>

    <div id='startDiv'>
        <div style='margin-bottom:10px;'>
            <a>What side are you playing?</a>
        </div>
        <button id='whiteStart'>White</button>
        <button id='blackStart'>Black</button>
    </div>

    <div id='blackInitial' style='display:none'>
        <a>Their move: </a>
        <input id='blackInitialMove'>
        <button id='submitBlackInitial'>Submit</button>
    </div>


    <div id='moveInterface' style='display:none;'>

        <div>
            <a>Your move: </a>
            <a id='yourMove'></a>
        </div>

        <div id='waitForOpponent'>
            <a>What move did your opponent play?</a>
            <input id='opponentMove' placeholder='Ex: Nf6'>
            <button id='submitOpponentMove'>Submit</button>
        </div>

    </div>

    <div id='doneMsg' style='display:none;'>
        <a>That's all we've got. Go win the game now.</a>
    </div>

</body>

<script>
curGame = [];
curOpening = '';
curOpeningLink = '';
var socket = io()

$('#whiteStart').on('click', function() {
    $('#startDiv').hide()
    socket.emit('opponent_move', {curGame})
})

$('#blackStart').on('click', function() {
    $('#startDiv').hide()
    $('#blackInitial').css('display', 'block')
})

$('#submitBlackInitial').on('click', function() {
    var opMove = $('#blackInitialMove').val()
    curGame.push(opMove)
    $('#gameInformation').show()
    socket.emit('opponent_move', {curGame})
})

$('#submitOpponentMove').on('click', function() {
    var opMove = $('#opponentMove').val()
    curGame.push(opMove)
    $('#gameInformation').show()
    socket.emit('opponent_move', {curGame})
})

socket.on('yourMove', function(data) {
    console.log(data)
    $('#yourMove').text(data['move'])
    curGame.push(data['move'])
    curOpening = data['name']
    $('#curGameList').text(curGame)
    $('#curOpeningName').text(curOpening)
    curOpeningLink = data['link']
    $('#curOpeningName').attr('href', curOpeningLink)
    $('#blackInitial').hide()
    $('#opponentMove').val('')
    $('#moveInterface').css('display', 'block')
});

socket.on('done', function() {
    $('#curGameList').text(curGame)
    $('#moveInterface').hide()
    $('#doneMsg').show()
});

</script>
</html>